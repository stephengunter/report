<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
   <title>Charts</title>
	<style>
		canvas {
			 padding-top: 20px;
		}
  </style>	
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> 
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.min.js"></script> 
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.4.0/dist/chartjs-plugin-datalabels.min.js"></script> 
	
</head>
<body>
<div class="container">
	<div class="row">
		<canvas id="chart_price_index"></canvas>
	</div>
	<div class="row">
		<canvas id="chart_rent_index"></canvas>
	</div>
	<div class="row" >
		<div class="col">
			<canvas id="pie_rent_people" style="height:300px;"></canvas>
		</div>
		<div class="col">
			<canvas id="need_rent_people" style="height:300px;"></canvas>
		</div>
	</div>
	<div class="row" >
		<div class="col">
			<canvas id="pie_know_people" style="height:300px;"></canvas>
		</div>
		<div class="col">
			<canvas id="pie_applyed_people" style="height:300px;"></canvas>
		</div>
	</div>
	<div class="row" >
		<div class="col">
			<canvas id="pie_approved" style="height:300px;"></canvas>
		</div>
		<div class="col">
			<canvas id="pie_whynot" style="height:300px;"></canvas>
		</div>
	</div>
	<canvas id="pie-chart"></canvas>
</div>


<script>
	$( document ).ready(function() {
		chart_price_index();
		rent_index();
		pie_rent_people();
		need_rent_people();
		pie_know_people();
		pie_applyed_people();
		pie_approved();
		pie_whynot();
	});
	function chart_price_index() {
		// 數據
		var labels = ["102Q1", "102Q2", "102Q3", "102Q4", "103Q1", "103Q2", "103Q3", "103Q4", "104Q1", "104Q2", 
							"104Q3", "104Q4", "105Q1", "105Q2", "105Q3", "105Q4", "106Q1", "106Q2", "106Q3", "106Q4", 
							"107Q1", "107Q2", "107Q3", "107Q4", "108Q1", "108Q2", "108Q3", "108Q4", "109Q1", "109Q2", 
							"109Q3", "109Q4", "110Q1", "110Q2", "110Q3", "110Q4", "111Q1", "111Q2", "111Q3", "111Q4", 
							"112Q1", "112Q2", "112Q3"];
		var values = [82.82, 86.71, 88.94, 90.77, 94.03, 95.65, 97.68, 99.07, 100.77, 100.15, 100.08, 99.6, 
							99.32, 100.76, 100.69, 99.09, 99.42, 99.86, 100.69, 100.6, 100.62, 100.08, 100.63, 100.8, 
							101.09, 101.59, 103.57, 104.14, 104.69, 105.39, 106.89, 108.17, 110.61, 112.42, 114.83, 
							117.5, 121.01, 123.97, 126.33, 127.51, 128.85, 130.8, 133.18];

		
		var ctx = document.getElementById('chart_price_index').getContext('2d');

		// 創建折線圖
		var chart_price_index = new Chart(ctx, {
			type: 'line',
			data: {
				labels: labels,
				datasets: [{
					label: '住宅價格指數',
					data: values,
					borderColor: 'rgb(75, 192, 192)',
					tension: 0.1
				}]
			},
			options: {
				legend: {
					display: true,
					labels: {
						fontSize: 32,
					}
				},
				plugins: {
					datalabels: {
						display: false
					},
					legend: {
						labels: {
							font: {
								size: 32,
								weight: '600',
							}
						}
					}
				},
				scales: {
					y: {
						beginAtZero: false,
						suggestedMin: 80, // Y 軸最小值
						suggestedMax: 140 // Y 軸最大值
					}
				}
			}
		});
	}
	function rent_index() {
		var data = `102/01,93.17
102/02,93.23
102/03,93.28
102/04,93.3
102/05,93.34
102/06,93.35
102/07,93.4
102/08,93.48
102/09,93.54
102/10,93.57
102/11,93.63
102/12,93.73
103/01,93.79
103/02,93.83
103/03,93.93
103/04,93.99
103/05,94.03
103/06,94.06
103/07,94.1
103/08,94.2
103/09,94.27
103/10,94.31
103/11,94.37
103/12,94.37
104/01,94.5
104/02,94.66
104/03,94.68
104/04,94.76
104/05,94.8
104/06,94.89
104/07,94.99
104/08,95.06
104/09,95.16
104/10,95.17
104/11,95.26
104/12,95.28
105/01,95.35
105/02,95.4
105/03,95.44
105/04,95.48
105/05,95.55
105/06,95.66
105/07,95.73
105/08,95.83
105/09,95.9
105/10,95.97
105/11,96.03
105/12,96.12
106/01,96.2
106/02,96.29
106/03,96.39
106/04,96.43
106/05,96.47
106/06,96.55
106/07,96.59
106/08,96.71
106/09,96.78
106/10,96.84
106/11,96.88
106/12,96.92
107/01,96.98
107/02,97.03
107/03,97.11
107/04,97.15
107/05,97.34
107/06,97.43
107/07,97.51
107/08,97.61
107/09,97.65
107/10,97.7
107/11,97.72
107/12,97.76
108/01,97.89
108/02,97.96
108/03,98.04
108/04,98.1
108/05,98.21
108/06,98.26
108/07,98.34
108/08,98.42
108/09,98.49
108/10,98.52
108/11,98.58
108/12,98.75
109/01,98.9
109/02,98.96
109/03,99.03
109/04,99.03
109/05,99.06
109/06,99.12
109/07,99.2
109/08,99.25
109/09,99.32
109/10,99.38
109/11,99.41
109/12,99.5
110/01,99.62
110/02,99.76
110/03,99.91
110/04,99.94
110/05,99.86
110/06,99.8
110/07,99.8
110/08,100.01
110/09,100.1
110/10,100.27
110/11,100.43
110/12,100.5
111/01,100.59
111/02,100.74
111/03,100.91
111/04,101.16
111/05,101.39
111/06,101.65
111/07,101.86
111/08,102.11
111/09,102.2
111/10,102.31
111/11,102.53
111/12,102.73
112/01,102.99
112/02,103.09
112/03,103.25
112/04,103.38
112/05,103.53
112/06,103.66
112/07,103.89
112/08,104.16
112/09,104.36
112/10,104.56
112/11,104.7
112/12,104.9
113/01,105.19
113/02,105.37
`
		data = data.replace(/\n/g, ',');
		var dataArray = data.split(',');
		// Initialize arrays to store times and values
		var times = [];
		var values = [];

		// Iterate over the array, pushing even-indexed elements (times) into times array and odd-indexed elements (values) into values array
		for (var i = 0; i < dataArray.length; i++) {
			if (i % 2 === 0) {
					times.push(dataArray[i]);
			} else {
					values.push(parseFloat(dataArray[i]));
			}
		}
		var ctx = document.getElementById('chart_rent_index').getContext('2d');

		// 創建折線圖
		var rent_price_index = new Chart(ctx, {
			type: 'line',
			data: {
				labels: times,
				datasets: [{
					label: '消費者物價房租類指數',
					data: values,
					borderColor: 'rgb(75, 192, 192)',
					tension: 0.1
				}]
			},
			options: {
				legend: {
					display: true,
					labels: {
						fontSize: 32,
					}
				},
				plugins: {
					datalabels: {
						display: false
					}
				},
				scales: {
					y: {
						beginAtZero: false,
						suggestedMin: 90, // Y 軸最小值
						suggestedMax: 108 // Y 軸最大值
					}
				}
			}
		});
	}
	function pie_rent_people() {
		var data = {
			labels: ['租屋', '自有住宅', '家人同住', '宿舍'],
			datasets: [{
					data: [30, 30, 1, 3],
					backgroundColor: [
						'orange',
						'Purple',
						'yellow',
						'green'
					],
					borderColor: 'white', // Border color of each slice
					borderWidth: 1 // Border width of each slice
			}]
		};
		var ctx = document.getElementById('pie_rent_people').getContext('2d');
        // Create the pie chart
      var myPieChart = new Chart(ctx, {
			type: 'pie',
			data: data,
			options: {
				responsive: false,
				title: {
					display: true,
					text: '居住現況',
					fontSize: 24
				},
				legend: {
					display: true,
					labels: {
						fontSize: 14
					}
				},
				plugins: {
					datalabels: {
						formatter: percent_formatter,
						color: '#fff',
					}
				}
			}
		});
	}
	function need_rent_people() {
		var data = {
			labels: ['是', '否'],
			datasets: [{
					data: [37, 29],
					backgroundColor: [
						'orange',
						'green'
					],
					borderColor: 'white', // Border color of each slice
					borderWidth: 1 // Border width of each slice
			}]
		};
		var ctx = document.getElementById('need_rent_people').getContext('2d');

        // Create the pie chart
      var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: data,
            options: {
				responsive: false,
				title: {
					display: true,
					text: '是否有租屋需求',
					fontSize: 24
				},
				legend: {
					display: true,
					labels: {
						fontSize: 14
					}
				},
				plugins: {
					datalabels: {
						formatter: percent_formatter,
						color: '#fff',
					}
				}
			}
		});
	}
	function pie_know_people() {
		var data = {
			labels: ['是', '否'],
			datasets: [{
					data: [61, 3],
					backgroundColor: [
						'green',
						'grey'
					],
					borderColor: 'white', // Border color of each slice
					borderWidth: 1 // Border width of each slice
			}]
		};
		var ctx = document.getElementById('pie_know_people').getContext('2d');

        // Create the pie chart
      var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: data,
            options: {
				responsive: false,
				title: {
					display: true,
					text: '是否知道房客可申請租屋補貼',
					fontSize: 24
				},
				legend: {
					display: true,
					labels: {
						fontSize: 14
					}
				},
				plugins: {
					datalabels: {
						formatter: percent_formatter,
						color: '#fff',
					}
				}
			}
		});
	}
	function pie_applyed_people() {
		var data = {
			labels: ['是', '否'],
			datasets: [{
					data: [9, 57],
					backgroundColor: [
						'green',
						'grey'
					],
					borderColor: 'white', // Border color of each slice
					borderWidth: 1 // Border width of each slice
			}]
		};
		var ctx = document.getElementById('pie_applyed_people').getContext('2d');

        // Create the pie chart
      var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: data,
            options: {
				responsive: false,
				title: {
					display: true,
					text: '是否申請過租屋補貼',
					fontSize: 24
				},
				legend: {
					display: true,
					labels: {
						fontSize: 14
					}
				},
				plugins: {
					datalabels: {
						formatter: percent_formatter,
						color: '#fff',
					}
				}
			}
		});
	}
	function pie_approved() {
		var data = {
			labels: ['已核可', '未核可'],
			datasets: [{
					data: [6, 3],
					backgroundColor: [
						'green',
						'grey'
					],
					borderColor: 'white', // Border color of each slice
					borderWidth: 1 // Border width of each slice
			}]
		};
		var ctx = document.getElementById('pie_approved').getContext('2d');

        // Create the pie chart
      var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: data,
            options: {
				responsive: false,
				title: {
					display: true,
					text: '申請租屋補貼者的核可比率',
					fontSize: 24
				},
				legend: {
					display: true,
					labels: {
						fontSize: 14
					}
				},
				plugins: {
					datalabels: {
						formatter: percent_formatter,
						color: '#fff',
					}
				}
			}
		});
	}
	function pie_whynot() {
		var data = {
			labels: ['房東不願意', '不知如何申請', '手續太繁雜'],
			datasets: [{
					data: [20, 7, 10],
					backgroundColor: [
						'purple',
						'green',
						'orange',
					],
					borderColor: 'white', // Border color of each slice
					borderWidth: 1 // Border width of each slice
			}]
		};
		var ctx = document.getElementById('pie_whynot').getContext('2d');
		var options = {
			responsive: false,
			tooltips: {
				enabled: false
			},
			title: {
				display: true,
				text: '不申請租屋補貼的原因(有租屋需求者)',
				fontSize: 24
			},
			legend: {
				display: true,
				labels: {
					fontSize: 14
				}
			},
   			plugins: {
     			datalabels: {
					formatter: percent_formatter,
       				color: '#fff',
				}
			}
		};
        // Create the pie chart
      var myPieChart = new Chart(ctx, {
            type: 'pie',
            data: data,
			options: options
		});
	}
	function percent_formatter(value, ctx) {
		let datasets = ctx.chart.data.datasets;
		if (datasets.indexOf(ctx.dataset) === datasets.length - 1) {
			let sum = datasets[0].data.reduce((a, b) => a + b, 0);
			let percentage = Math.round((value / sum) * 100) + '%';
			return percentage;
		} else {
			return percentage;
		}
	}
</script>
</body>
</html>
